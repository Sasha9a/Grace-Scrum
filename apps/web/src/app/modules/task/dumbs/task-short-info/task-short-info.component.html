<div *ngIf="task">
  <div class="flex justify-content-between align-items-center">
    <a routerLink="/task/card/{{ task._id }}" target="_blank">{{ task.board?.code }}-{{ task.number }}</a>
    <button pButton type="button" icon="pi pi-times" class="p-button-rounded p-button-danger p-button-text" (click)="task = null"></button>
  </div>
  <p class="mt-3">{{ task.name }}</p>
  <div class="grid">
    <div class="col-5 text-gray-500">Оценка:</div>
    <div *ngIf="task.grade" class="col-7">{{ task.grade }} ч.</div>
    <div *ngIf="!task.grade" class="col-7">Неизвестно</div>
  </div>
  <div class="grid">
    <div class="col-5 text-gray-500">Осталось:</div>
    <div *ngIf="task.left" class="col-7">{{ task.left }} ч.</div>
    <div *ngIf="!task.left" class="col-7">Неизвестно</div>
  </div>

  <div class="mt-3">
    <button pButton type="button" label="Запись о работе" class="p-button-text p-button-info"></button>
  </div>

  <div class="mt-3">
    <h4 class="my-0">Детали задачи</h4>
    <div class="grid mt-2">
      <div class="col-5 text-gray-500">Статус:</div>
      <div class="col-7">
        <div class="p-1 font-bold" [ngStyle]="{ 'background-color': task.status?.color }">{{ task.status?.name }}</div>
      </div>
    </div>
    <div class="grid mt-2">
      <div class="col-5 text-gray-500">Приоритет:</div>
      <div class="col-7">{{ task.priority | taskPriorityName }}</div>
    </div>
  </div>

  <div class="mt-3">
    <h4 class="my-0">Люди</h4>
    <div class="grid mt-2">
      <div class="col-5 text-gray-500">Автор:</div>
      <div class="col-7">
        <div class="flex align-items-center">
          <grace-user-avatar [user]="{ name: task.createdUser?.name, login: task.createdUser?.login, file: task.createdUser?.avatar }"></grace-user-avatar>
          <p>{{ task.createdUser?.name || task.createdUser?.login }}</p>
        </div>
      </div>
    </div>
    <div class="grid mt-2">
      <div class="col-5 text-gray-500">Исполнитель:</div>
      <div class="col-7">
        <div *ngIf="task.executor" class="flex align-items-center">
          <grace-user-avatar [user]="{ name: task.executor?.name, login: task.executor?.login, file: task.executor?.avatar }"></grace-user-avatar>
          <p>{{ task.executor?.name || task.executor?.login }}</p>
        </div>
        <div *ngIf="!task.executor">Не назначен</div>
      </div>
    </div>
  </div>

  <div class="mt-3">
    <h4 class="my-0">Даты</h4>
    <div class="grid mt-2">
      <div class="col-5 text-gray-500">Создано:</div>
      <div class="col-7">{{ task.createDate | date: 'dd MMMM yyyy HH:mm' }}</div>
    </div>
    <div class="grid mt-2">
      <div class="col-5 text-gray-500">Обновлено:</div>
      <div class="col-7">{{ task.updateDate | date: 'dd MMMM yyyy HH:mm' }}</div>
    </div>
  </div>

  <div class="mt-3">
    <h4 class="my-0">Описание</h4>
    <div>{{ task.description }}</div>
  </div>

  <div class="mt-3">
    <h4 class="my-0">Вложенные файлы</h4>
    <div class="flex gap-2">
      <ng-container *ngFor="let file of task.files">
        <grace-file *ngIf="file" [file]="file"></grace-file>
      </ng-container>
    </div>
  </div>
</div>
